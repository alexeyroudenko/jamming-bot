<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jamming bot — Screenshots</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #000;
      color: #fff;
      font-family: "Lucida Grande", Arial, Helvetica, sans-serif;
      overflow: hidden;
      width: 100vw;
      height: 100vh;
    }

    nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      padding: 12px 20px;
      font-size: 11px;
      color: #666;
      z-index: 10;
      display: flex;
      justify-content: space-between;
    }
    nav a { color: #555; text-decoration: none; margin-right: 12px; }
    nav a:hover { color: #fff; }
    #status { color: #333; font-size: 10px; }

    #stage {
      position: relative;
      width: 100vw;
      height: 100vh;
    }

    .shot {
      position: absolute;
      height: 384px;
      width: auto;
      opacity: 0;
      transition: opacity 0.6s ease-in;
      border: 1px solid #222;
    }
    .shot.visible { opacity: 1; }
  </style>
</head>
<body>

<nav>
  <div>
    <a href="/">← home</a>
    <a href="/tags/">tag cloud</a>
  </div>
  <span id="status">waiting…</span>
</nav>

<div id="stage"></div>

<script src="https://cdn.socket.io/4.7.5/socket.io.min.js" integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO" crossorigin="anonymous"></script>
<script>
(function () {
  var IMG_H = 384;
  var IMG_W = 216;
  var MAX_IMAGES = 200;

  var statusEl = document.getElementById('status');
  var stage = document.getElementById('stage');
  var count = 0;

  var socket = io({ transports: ['websocket', 'polling'] });

  socket.on('connect', function () {
    statusEl.textContent = 'live';
  });

  socket.on('disconnect', function () {
    statusEl.textContent = 'disconnected';
  });

  socket.on('screenshot', function (data) {
    if (!data || !data.screenshot_url) return;

    var vw = window.innerWidth;
    var vh = window.innerHeight;
    var x = Math.random() * Math.max(0, vw - IMG_W);
    var y = Math.random() * Math.max(0, vh - IMG_H);

    var img = document.createElement('img');
    img.className = 'shot';
    img.src = data.screenshot_url;
    img.style.left = x + 'px';
    img.style.top = y + 'px';
    img.title = data.url || '';

    stage.appendChild(img);

    requestAnimationFrame(function () {
      requestAnimationFrame(function () {
        img.classList.add('visible');
      });
    });

    count++;
    statusEl.textContent = count + ' screenshot' + (count === 1 ? '' : 's');

    while (stage.children.length > MAX_IMAGES) {
      stage.removeChild(stage.firstChild);
    }
  });
})();
</script>

</body>
</html>
